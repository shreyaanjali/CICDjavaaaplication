@Library('my-shared-library') _

pipeline {
    agent any

    parameters{
        choice(name:'action', choices: 'create\ndelete', description: 'Choose create/Destroy')

    }

    stages{


        when { expression { param.action == 'create' }}
        stage('Git Checkout') {
            steps{
            gitCheckout(
                branch: "main",
                url: "https://github.com/shreyaanjali/CICDjavaaaplication.git"
                    )   
                }
            }

            stage('Unit Test maven'){
            when { expression { param.action == 'create' }}

            steps{
               script{

                mvnTest()

                }  
            }
        }
        stage('Integration Test Test maven'){
            when { expression { param.action == 'create' }}

            steps{
               script{

                mvnIntegrationTest()

                }  
            }
        }

        stage('Static code analysis: Sonarqube'){
            when { expression { param.action == 'create' }}

            steps{
               script{

                staticCodeAnalysis()

                }  
            }
        }
    }

}

